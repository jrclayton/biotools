col = "red",
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1",
xlim = c(0,max(as.numeric(Var1))
)
summary(x19pos)
summary(x19pos)
x19pos <- as.data.frame(as.table(tapply(x19mers$V2, x19mers$V1, length)))
x19pos$Var1 <- as.numeric(x19pos$Var1)
summary(x19pos)
plot(Freq ~ Var1, data = x19pos, type = "h",
col = "red",
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1",
xlim = c(0,max(as.numeric(Var1))
)
plot(Freq ~ Var1, data = x19pos, type = "h",
col = "red",
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1",
xlim = c(0,max(Var1))
)
plot(Freq ~ Var1, data = x19pos, type = "h",
col = "red",
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1",
xlim = c(0,max(Var1))
)
x19pos
x19pos <- as.data.frame(as.table(tapply(x19mers$V2, x19mers$V1, length)))
x19pos
x19pos$Var1 <- as.numeric(x19pos$Var1)
x19pos
x19pos$Var1 <- as.integer(x19pos$Var1)
x19pos
x19pos <- as.data.frame(as.table(tapply(x19mers$V2, x19mers$V1, length)))
x19pos$Var1 <- as.integer(x19pos$Var1)
x19pos
x19pos <- as.data.frame(as.table(tapply(x19mers$V2, x19mers$V1, length)))
x19pos
plot(Freq ~ Var1, data = x19pos, type = "p",
pch = 19,
col = "red",
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1",
xlim = c(0,max(Var1))
)
plot(Freq ~ Var1, data = x19pos, type = "p",
pch = 19,
col = "red",
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1",
xlim = c(0,694)
)
plot(x19pos$Freq ~ as.numeric(x19pos$Var1), type = "p",
pch = 19,
col = "red",
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1",
xlim = c(0,694)
)
as.numeric(x19pos$Var1)
plot(x19pos$Freq ~ x19pos$Var1,
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1"
)
plot(x19pos$Freq ~ x19pos$Var1,
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1"
)
barplot(x19pos$Freq ~ x19pos$Var1,
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1"
)
scatterplot(x19pos$Freq ~ x19pos$Var1,
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1"
)
stripchart(x19pos$Freq ~ x19pos$Var1,
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1"
)
stripchart(x19pos$Var1 ~ x19pos$Freq,
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1"
)
stripchart(x = x19pos$Var1 y =  x19pos$Freq,
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1"
)
stripchart(x = x19pos$Var1, y =  x19pos$Freq,
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1"
)
x19pos <- as.data.frame(as.table(tapply(x19mers$V2, x19mers$V1, length)))
x19pos
x19mers <- subset(table, V3 == 19)
x19pos <- as.table(tapply(x19mers$V2, x19mers$V1, length))
x20mers <- subset(table, V3 == 20)
x20pos <- as.table(tapply(x20mers$V2, x20mers$V1, length))
x21mers <- subset(table, V3 == 21)
x21pos <- as.table(tapply(x21mers$V2, x21mers$V1, length))
x22mers <- subset(table, V3 == 22)
x22pos <- as.table(tapply(x22mers$V2, x22mers$V1, length))
x23mers <- subset(table, V3 == 23)
x23pos <- as.table(tapply(x23mers$V2, x23mers$V1, length))
x24mers <- subset(table, V3 == 24)
x24pos <- as.table(tapply(x24mers$V2, x24mers$V1, length))
plot(x19pos, type = "h",
xlab = "Position",
ylab = "Reads",
main = "20 bp reads mapped to dsTep1",
xlim = c(0,x.max)
)
max(x19pos)
x19pos
plot(x19pos, type = "h",
xlab = "Position",
ylab = "Reads",
main = "20 bp reads mapped to dsTep1"
xlim = c(0,100)
)
plot(x19pos, type = "h",
xlab = "Position",
ylab = "Reads",
main = "20 bp reads mapped to dsTep1"
xlim = c(0,100)
)
plot(x19pos, type = "h",
xlab = "Position",
ylab = "Reads",
main = "20 bp reads mapped to dsTep1",
xlim = c(0,100)
)
plot(x19pos, type = "h",
xlab = "Position",
ylab = "Reads",
main = "20 bp reads mapped to dsTep1",
xlim = c(0,200)
)
x19df <- as.data.frame(x19pos)
xvals <- x19df$Val1
yvals <- x19df$Freq
class(xvals)
xvals
x19df
xvals <- x19df$Var1
yvals <- x19df$Freq
x20mers <- subset(table, V3 == 20)
class(xvals)
xvals
as.numeric(xvals)
class(table)
table
summary(table)
class(table$V1)
max(table$V1)
x.max <- max(table$V1)
x.max
total.positional.reads <- tapply(table$V2, table$V1, length)
class(total.positional.reads)
total.positional.reads
total.positional.reads <- as.data.frame(as.table(tapply(table$V2, table$V1, length)))
total.positional.reads
total.positional.reads <- as.data.frame(tapply(table$V2, table$V1, length))
total.positional.reads
str(total.positional.reads)
total.positional.reads[1]
total.positional.reads[2]
total.positional.reads <- as.data.frame(as.table(tapply(table$V2, table$V1, length)))
total
total.positional.reads
str(total.positional.reads)
totals <- as.data.frame(as.table(tapply(table$V2, table$V1, length)))
str(totals)
totals$pos <- as.numeric(totals$Var1
)
totals
totals$Val1
totals$Var1
as.list(totals$Var1)
as.integer(totals$Var1)
as.factor(totals$Var1)
as.character(totals$Var1)
as.numeric(as.character(totals$Var1))
totals$pos <- as.numeric(as.character(totals$Var1))
totals
str(totals)
totals$pos <- as.integer(as.character(totals$Var1))
str(totals)
table <- read.delim("~/Desktop/table.tab", header=F)
#add count data
table[,3] <- nchar(as.character(table[,2]))
#histogram of reads by length
hist(table$V3)
#calculate max for x-axis
x.max <- max(table$V1)
#reads by position plot, all reads
totals <- as.data.frame(as.table(tapply(table$V2, table$V1, length)))
totals$pos <- as.integer(as.character(totals$Var1))
totals
head(table)
summary(table)
totals
max(totals$pos)
totals$pos <- as.integer(as.character(totals$Var1))
totals
table <- read.delim("~/Desktop/table.tab", header=F)
#add count data
table[,3] <- nchar(as.character(table[,2]))
#histogram of reads by length
hist(table$V3)
#reads by position plot, all reads
totals <- as.data.frame(as.table(tapply(table$V2, table$V1, length)))
totals$pos <- as.integer(as.character(totals$Var1))
#plot all reads on single graph
plot(totals, type = "h",
xlab = "Position",
ylab = "Reads",
main = "19-24 bp reads mapped to dsTep1",
xlim = c(0,max(totals$pos))
)
#plot all reads on single graph
plot(Freq ~ pos, data = totals, type = "h",
xlab = "Position",
ylab = "Reads",
main = "19-24 bp reads mapped to dsTep1",
xlim = c(0,max(totals$pos))
)
x19mers <- subset(table, V3 == 19)
summary(x19mers)
x19pos <- tapply(x19mers$V2, x19mers$V1, length))
x19mers$V1
x19pos <- as.data.frame(as.table(tapply(x19mers$V2, x19mers$V1, length)))
summary(x19pos)
x19por
x19pos
class(x19pos$V1)
summary(x19pos)
summary(x19pos$Var1)
class(x19pos$Var1)
x19counted
x19counted <- as.data.frame(as.table(tapply(x19mers$V2, x19mers$V1, length)))
x19counted
x19counted$pos <- as.integer(as.character(totals$Var1))
x19counted$pos <- as.integer(as.character(x19counted$Var1))
x19counted
summary(x19counted)
class(x19mers)
source('~/analysis.R', echo=TRUE)
plot(Freq ~ pos, data = x19counted, type = "h",
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1",
xlim = c(0,max(x19counted$pos))
)
plot(Freq ~ pos, data = x20counted, type = "h",
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1",
xlim = c(0,max(x20counted$pos))
)
plot(Freq ~ pos, data = x21counted, type = "h",
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1",
xlim = c(0,max(x21counted$pos))
)
plot(Freq ~ pos, data = x22counted, type = "h",
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1",
xlim = c(0,max(x22counted$pos))
)
plot(Freq ~ pos, data = x23counted, type = "h",
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1",
xlim = c(0,max(x23counted$pos))
)
plot(Freq ~ pos, data = x24counted, type = "h",
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1",
xlim = c(0,max(x24counted$pos))
)
table <- read.delim("~/Desktop/table.tab", header=F)
#add count data
table[,3] <- nchar(as.character(table[,2]))
#histogram of reads by length
hist(table$V3)
#reads by position plot, all reads
totals <- as.data.frame(as.table(tapply(table$V2, table$V1, length)))
totals$pos <- as.integer(as.character(totals$Var1))
#plot all reads on single graph
plot(Freq ~ pos, data = totals, type = "h",
xlab = "Position",
ylab = "Reads",
main = "19-24 bp reads mapped to dsTep1",
xlim = c(0,max(totals$pos))
)
#subset by size
x19mers <- subset(table, V3 == 19)
x20mers <- subset(table, V3 == 20)
x21mers <- subset(table, V3 == 21)
x22mers <- subset(table, V3 == 22)
x23mers <- subset(table, V3 == 23)
x24mers <- subset(table, V3 == 24)
# count the number of each unique sequence by position
x19counted <- as.data.frame(as.table(tapply(x19mers$V2, x19mers$V1, length)))
x20counted <- as.data.frame(as.table(tapply(x20mers$V2, x20mers$V1, length)))
x21counted <- as.data.frame(as.table(tapply(x21mers$V2, x21mers$V1, length)))
x22counted <- as.data.frame(as.table(tapply(x22mers$V2, x22mers$V1, length)))
x23counted <- as.data.frame(as.table(tapply(x23mers$V2, x23mers$V1, length)))
x24counted <- as.data.frame(as.table(tapply(x24mers$V2, x24mers$V1, length)))
# add a column with positional infor as numeric for plotting
x19counted$pos <- as.integer(as.character(x19counted$Var1))
x20counted$pos <- as.integer(as.character(x20counted$Var1))
x21counted$pos <- as.integer(as.character(x21counted$Var1))
x22counted$pos <- as.integer(as.character(x22counted$Var1))
x23counted$pos <- as.integer(as.character(x23counted$Var1))
x24counted$pos <- as.integer(as.character(x24counted$Var1))
#reads by position plot, 19mers
plot(Freq ~ pos, data = x19counted, type = "h",
xlab = "Position",
ylab = "Reads",
main = "19 bp reads mapped to dsTep1",
xlim = c(0,max(x19counted$pos))
)
plot(Freq ~ pos, data = x20counted, type = "h",
xlab = "Position",
ylab = "Reads",
main = "20 bp reads mapped to dsTep1",
xlim = c(0,max(x20counted$pos))
)
plot(Freq ~ pos, data = x21counted, type = "h",
xlab = "Position",
ylab = "Reads",
main = "21 bp reads mapped to dsTep1",
xlim = c(0,max(x21counted$pos))
)
plot(Freq ~ pos, data = x22counted, type = "h",
xlab = "Position",
ylab = "Reads",
main = "22 bp reads mapped to dsTep1",
xlim = c(0,max(x22counted$pos))
)
plot(Freq ~ pos, data = x23counted, type = "h",
xlab = "Position",
ylab = "Reads",
main = "23 bp reads mapped to dsTep1",
xlim = c(0,max(x23counted$pos))
)
plot(Freq ~ pos, data = x24counted, type = "h",
xlab = "Position",
ylab = "Reads",
main = "24 bp reads mapped to dsTep1",
xlim = c(0,max(x24counted$pos))
)
# #make an overplotted graph with all lengths plotted in separate colors
#
# plot(total.positional.reads, type = "n",
#      xlab = "Position",
#      ylab = "Reads",
#      main = "19-24 bp reads mapped to dsTep1",
#      xlim = c(0,x.max),
#      ylim = c(0,max(total.positional.reads))
#      )
#
# points(as.(x19pos), col = "red", pch = 19)
# points(x20pos, col = "green", pch = 19)
# points(x21pos, col = "blue", pch = 19)
# points(x22pos, col = "cyan", pch = 19)
# points(x23pos, col = "magenta", pch = 19)
# points(x24pos, col = "violet", pch = 19)
# points(total.positional.reads, pch = 19, col = "black")
#
# #make a table of read counts by position and size for export
totals
summary(totals)
plot(totals, type = "h",
xlab = "Position",
ylab = "Reads",
main = "19-24 bp reads mapped to dsTep1",
xlim = c(0,max(totals$pos)),
ylim = c(0,max(totalsFreq))
)
plot(totals, type = "h",
xlab = "Position",
ylab = "Reads",
main = "19-24 bp reads mapped to dsTep1",
xlim = c(0,max(totals$pos)),
ylim = c(0,max(totals$Freq))
)
plot(Freq ~ pos, data = totals, type = "h",
xlab = "Position",
ylab = "Reads",
main = "19-24 bp reads mapped to dsTep1",
xlim = c(0,max(totals$pos)),
ylim = c(0,max(totals$Freq))
)
points(Freq ~ pos, data = x19counted, col = "red", pch = 19)
points(Freq ~ pos, data = x20counted, col = "green", pch = 19)
points(Freq ~ pos, data = x21counted, col = "blue", pch = 19)
points(Freq ~ pos, data = x22counted, col = "cyan", pch = 19)
points(Freq ~ pos, data = x23counted, col = "magenta", pch = 19)
points(Freq ~ pos, data = x24counted, col = "violet", pch = 19)
output <- rbind(x19counted,x20counted,x22counted,x22counted,x23counted,x24counted)
output
max.print = 4000
output
getOption("max.print")
sort(output, by = output$pos)
?sort
?order
order(output)
order(output$pos)
order(output$pos,order$Freq)
output
summary(output)
output[with(output, order(pos, Freq)), ]
x <- output[with(output, order(pos, Freq)), ]
summary(x)
head(x)
output
summary(output)
x19counted
x19conted$len <- 19
x19counted$len <- 19
x19counted
x19counted$len <- 19
x20counted$len <- 20
x21counted$len <- 21
x22counted$len <- 22
x23counted$len <- 23
x24counted$len <- 24
x19counted$len <- 19
x20counted$len <- 20
x21counted$len <- 21
x22counted$len <- 22
x23counted$len <- 23
x24counted$len <- 24
output <- rbind(x19counted,x20counted,x22counted,x22counted,x23counted,x24counted)
output <- output[with(output, order(pos, len, Freq)), ]
output
head(output, n=100)
data.frame(Position = output$pos, Length = output$len, Reads = output$Freq)
reordered <- output[with(output, order(pos, len, Freq)), ]
output <- output[with(output, order(pos, len, Freq)), ]
output <- data.frame(Position = output$pos, Length = output$len, Reads = output$Freq)
class(output)
print(output)
output <- rbind(x19counted,x20counted,x22counted,x23counted,x24counted)
#sort by column
output <- output[with(output, order(pos, len, Freq)), ]
output <- data.frame(Position = output$pos, Length = output$len, Reads = output$Freq)
print(output)
print(output)
output <- rbind(x19counted,x20counted,x21counted,x22countedx23counted,x24counted)
#sort by column
output <- rbind(x19counted, x20counted, x21counted, x22countedx, 23counted, x24counted)
output <- rbind(x19counted, x20counted, x21counted, x22countedx, x23counted, x24counted)
output <- rbind(x19counted, x20counted, x21counted, x22counted, x23counted, x24counted)
#sort by column
output <- output[with(output, order(pos, len, Freq)), ]
output <- data.frame(Position = output$pos, Length = output$len, Reads = output$Freq)
print(output)
print(output)
summary(output)
?write.csv
?write.csv(output)
write.csv(output)
outputp[1:3]
output[,1:3]
output[,1:2]
output[,1:3]
write.csv(x = output, file = "output.txt")
q()
?plot
?stripchart
q()
q()
q()
ls()
q()
q()
install.packages("knitr")
q()
q()
q()
setwd(.)
setwd(".")
getwd()
setwd("..")
getwd()
setwd("/Users/jrclayton/Desktop/SAM2xls/")
q()
